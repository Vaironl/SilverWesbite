stages:
  - build
  - deploy
  
# build-job:
#   tags:
#     - 410silver
#   stage: build
#   script:
#     - echo "listing files"
#     - ls -l
    
#   only:
#     - master
#     - developer

deploy-job:
  tags:
    - 410silver
  stage: deploy
  script:
    - apt-get update
    - echo "${SSH_PRIVATE_KEY}" > id_rsa
    - chmod 700 id_rsa
    - mkdir "${HOME}/.ssh"
    - echo "${SSH_HOST_KEY}" > "${HOME}/.ssh/known_hosts"
    - rsync -auvz -e "ssh" ./index.html nmendoza@atria.cs.odu.edu:public/
    # - eval $(ssh-agent -s)
    # - ssh-add <(echo "$RSYNC_KEY")
    # - ls
    # - cat ~/.ssh/
    # - rsync -auvz -e "ssh" ./index.html nmendoza@atria.cs.odu.edu:public/
    # - ssh-agent -k
  only:
    - master
    - developer